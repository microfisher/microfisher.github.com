(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{454:function(t,e,a){"use strict";a.r(e);var s=a(0),n=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"contract-design-upgradability"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#contract-design-upgradability"}},[t._v("#")]),t._v(" Contract Design & Upgradability")]),t._v(" "),e("br"),t._v(" "),e("h2",{attrs:{id:"architecture"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#architecture"}},[t._v("#")]),t._v(" Architecture")]),t._v(" "),e("p",[t._v("The Rocket Pool network contracts are built with upgradability in mind, using a hub-and-spoke architecture.\nThe central hub of the network is the "),e("code",[t._v("RocketStorage")]),t._v(" contract, which is responsible for storing the state of the entire network.\nThis is implemented through the use of maps for key-value storage, and getter and setter methods for reading and writing values for a key.")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("RocketStorage")]),t._v(" contract also stores the addresses of all other network contracts (keyed by name), and restricts data modification to those contracts only.\nUsing this architecture, the network can be upgraded by deploying new versions of an existing contract, and updating its address in storage.\nThis gives Rocket Pool the flexibility required to fix bugs or implement new features to improve the network.")]),t._v(" "),e("br"),t._v(" "),e("h2",{attrs:{id:"interacting-with-rocket-pool"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#interacting-with-rocket-pool"}},[t._v("#")]),t._v(" Interacting With Rocket Pool")]),t._v(" "),e("p",[t._v("To begin interacting with the Rocket Pool network, first create an instance of the "),e("code",[t._v("RocketStorage")]),t._v(" contract using "),e("a",{attrs:{href:"https://github.com/rocket-pool/rocketpool/blob/master/contracts/interface/RocketStorageInterface.sol",target:"_blank",rel:"noopener noreferrer"}},[t._v("its interface"),e("OutboundLink")],1),t._v(":")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"RocketStorageInterface.sol"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("contract")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Example")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    RocketStorageInterface rocketStorage "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("RocketStorageInterface")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("constructor")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" _rocketStorageAddress"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        rocketStorage "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("RocketStorageInterface")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_rocketStorageAddress"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("The above constructor should be called with the address of the "),e("code",[t._v("RocketStorage")]),t._v(" contract on the appropriate network.")]),t._v(" "),e("p",[t._v("Because of Rocket Pool's architecture, the addresses of other contracts should not be used directly, but retrieved from the blockchain before use.\nNetwork upgrades may have occurred since the previous interaction, resulting in outdated addresses.")]),t._v(" "),e("p",[t._v("Other contract instances can be created using the appropriate interface taken from the "),e("a",{attrs:{href:"https://github.com/rocket-pool/rocketpool/tree/master/contracts/interface",target:"_blank",rel:"noopener noreferrer"}},[t._v("Rocket Pool repository"),e("OutboundLink")],1),t._v(", e.g.:")]),t._v(" "),e("div",{staticClass:"language-solidity extra-class"},[e("pre",{pre:!0,attrs:{class:"language-solidity"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"RocketStorageInterface.sol"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"RocketDepositPoolInterface.sol"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("contract")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Example")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    RocketStorageInterface rocketStorage "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("RocketStorageInterface")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("constructor")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" _rocketStorageAddress"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        rocketStorage "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("RocketStorageInterface")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_rocketStorageAddress"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("exampleMethod")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("address")]),t._v(" rocketDepositPoolAddress "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rocketStorage"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAddress")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("keccak256")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("abi"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("encodePacked")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"contract.address"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rocketDepositPool"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        RocketDepositPoolInterface rocketDepositPool "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("RocketDepositPoolInterface")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rocketDepositPoolAddress"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("The Rocket Pool contracts, as defined in "),e("code",[t._v("RocketStorage")]),t._v(", are:")]),t._v(" "),e("ul",[e("li",[e("p",[e("code",[t._v("rocketRole")]),t._v(" - Handles assignment of privileged admin roles (internal)")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketVault")]),t._v(" - Stores ETH held by network contracts (internal, not upgradeable)")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketUpgrade")]),t._v(" - Provides upgrade functionality for the network (internal)")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketDepositPool")]),t._v(" - Accepts user-deposited ETH and handles assignment to minipools")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketMinipoolFactory")]),t._v(" - Creates minipool contract instances (internal)")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketMinipoolManager")]),t._v(" - Creates & manages all minipools in the network")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketMinipoolQueue")]),t._v(" - Organises minipools into a queue for ETH assignment")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketMinipoolStatus")]),t._v(" - Handles minipool status updates from watchtower nodes")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketNetworkBalances")]),t._v(" - Handles network balance updates from watchtower nodes")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketNetworkFees")]),t._v(" - Calculates node commission rates based on network node demand")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketNetworkWithdrawal")]),t._v(" - Handles processing of beacon chain validator withdrawals")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketNodeDeposit")]),t._v(" - Handles node deposits for minipool creation")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketNodeManager")]),t._v(" - Registers & manages all nodes in the network")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketDAOProtocolSettingsDeposit")]),t._v(" - Provides network settings relating to deposits")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketDAOProtocolSettingsMinipool")]),t._v(" - Provides network settings relating to minipools")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketDAOProtocolSettingsNetwork")]),t._v(" - Provides miscellaneous network settings")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketDAOProtocolSettingsNode")]),t._v(" - Provides network settings relating to nodes")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("rocketTokenRETH")]),t._v(" - The rETH token contract (not upgradeable)")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("addressQueueStorage")]),t._v(" - A utility contract (internal)")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("addressSetStorage")]),t._v(" - A utility contract (internal)")])])]),t._v(" "),e("p",[t._v('Contracts marked as "internal" do not provide methods which are accessible to the general public, and so are generally not useful for extension.\nFor information on specific contract methods, consult their interfaces in the '),e("a",{attrs:{href:"https://github.com/rocket-pool/rocketpool/tree/master/contracts/interface",target:"_blank",rel:"noopener noreferrer"}},[t._v("Rocket Pool repository"),e("OutboundLink")],1),t._v(".")])])}),[],!1,null,null,null);e.default=n.exports}}]);