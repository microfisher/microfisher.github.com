<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>[WIP] Go Library | Rocket Pool</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Rocket Pool Documentation - Decentralised ETH2 Proof of Stake Protocol">
    <meta name="theme-color" content="#e57147">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.75cec9a2.css" as="style"><link rel="preload" href="/assets/js/app.8dab053a.js" as="script"><link rel="preload" href="/assets/js/3.12e2602a.js" as="script"><link rel="preload" href="/assets/js/84.8e331b8d.js" as="script"><link rel="prefetch" href="/assets/js/1.db0f8477.js"><link rel="prefetch" href="/assets/js/10.93e661cb.js"><link rel="prefetch" href="/assets/js/100.4a3b3254.js"><link rel="prefetch" href="/assets/js/101.70092a0f.js"><link rel="prefetch" href="/assets/js/102.117b4113.js"><link rel="prefetch" href="/assets/js/103.9a53538f.js"><link rel="prefetch" href="/assets/js/104.ea6b820b.js"><link rel="prefetch" href="/assets/js/105.1a1012e2.js"><link rel="prefetch" href="/assets/js/106.f06794f5.js"><link rel="prefetch" href="/assets/js/107.cd450e91.js"><link rel="prefetch" href="/assets/js/108.9e3b8698.js"><link rel="prefetch" href="/assets/js/109.c9445cb2.js"><link rel="prefetch" href="/assets/js/11.37034cad.js"><link rel="prefetch" href="/assets/js/110.4688b55b.js"><link rel="prefetch" href="/assets/js/111.d7cb63c4.js"><link rel="prefetch" href="/assets/js/112.0c68352b.js"><link rel="prefetch" href="/assets/js/12.d5f09731.js"><link rel="prefetch" href="/assets/js/13.75185414.js"><link rel="prefetch" href="/assets/js/14.4f79624b.js"><link rel="prefetch" href="/assets/js/15.5e31743d.js"><link rel="prefetch" href="/assets/js/16.36f544f5.js"><link rel="prefetch" href="/assets/js/17.9117da0b.js"><link rel="prefetch" href="/assets/js/18.870fbb96.js"><link rel="prefetch" href="/assets/js/19.5dbb6b8e.js"><link rel="prefetch" href="/assets/js/20.0b7aba61.js"><link rel="prefetch" href="/assets/js/21.05b5aad4.js"><link rel="prefetch" href="/assets/js/22.ac8b3c2e.js"><link rel="prefetch" href="/assets/js/23.4e425876.js"><link rel="prefetch" href="/assets/js/24.b3085771.js"><link rel="prefetch" href="/assets/js/25.ed624ff2.js"><link rel="prefetch" href="/assets/js/26.a9d96b3b.js"><link rel="prefetch" href="/assets/js/27.57a1fa4d.js"><link rel="prefetch" href="/assets/js/28.7fa3d2f3.js"><link rel="prefetch" href="/assets/js/29.83ee6233.js"><link rel="prefetch" href="/assets/js/30.60900fac.js"><link rel="prefetch" href="/assets/js/31.a7e8f130.js"><link rel="prefetch" href="/assets/js/32.d74da397.js"><link rel="prefetch" href="/assets/js/33.15fe159f.js"><link rel="prefetch" href="/assets/js/34.648bfe26.js"><link rel="prefetch" href="/assets/js/35.d157db4e.js"><link rel="prefetch" href="/assets/js/36.dd203ccf.js"><link rel="prefetch" href="/assets/js/37.68066095.js"><link rel="prefetch" href="/assets/js/38.d13298d3.js"><link rel="prefetch" href="/assets/js/39.51b5f7e1.js"><link rel="prefetch" href="/assets/js/4.93eafb42.js"><link rel="prefetch" href="/assets/js/40.7a88b34d.js"><link rel="prefetch" href="/assets/js/41.d595b285.js"><link rel="prefetch" href="/assets/js/42.8eb935aa.js"><link rel="prefetch" href="/assets/js/43.09d57c9a.js"><link rel="prefetch" href="/assets/js/44.9087b29a.js"><link rel="prefetch" href="/assets/js/45.3321eed8.js"><link rel="prefetch" href="/assets/js/46.44596f43.js"><link rel="prefetch" href="/assets/js/47.73c8c474.js"><link rel="prefetch" href="/assets/js/48.52075a18.js"><link rel="prefetch" href="/assets/js/49.fb6b52f1.js"><link rel="prefetch" href="/assets/js/5.f1d02ded.js"><link rel="prefetch" href="/assets/js/50.78269f80.js"><link rel="prefetch" href="/assets/js/51.b516b7f5.js"><link rel="prefetch" href="/assets/js/52.5713dc75.js"><link rel="prefetch" href="/assets/js/53.fe59dc31.js"><link rel="prefetch" href="/assets/js/54.7c03702d.js"><link rel="prefetch" href="/assets/js/55.39ab7f3a.js"><link rel="prefetch" href="/assets/js/56.2d39c3d5.js"><link rel="prefetch" href="/assets/js/57.98d3e67c.js"><link rel="prefetch" href="/assets/js/58.3d77d46d.js"><link rel="prefetch" href="/assets/js/59.2b2ea81d.js"><link rel="prefetch" href="/assets/js/6.5c392ee3.js"><link rel="prefetch" href="/assets/js/60.f414e060.js"><link rel="prefetch" href="/assets/js/61.5127c924.js"><link rel="prefetch" href="/assets/js/62.ad943789.js"><link rel="prefetch" href="/assets/js/63.a5c44dea.js"><link rel="prefetch" href="/assets/js/64.fac9dafb.js"><link rel="prefetch" href="/assets/js/65.e1920713.js"><link rel="prefetch" href="/assets/js/66.4b7060c3.js"><link rel="prefetch" href="/assets/js/67.1b42a542.js"><link rel="prefetch" href="/assets/js/68.a58c4dfa.js"><link rel="prefetch" href="/assets/js/69.3cfd86fc.js"><link rel="prefetch" href="/assets/js/7.ef04408a.js"><link rel="prefetch" href="/assets/js/70.26c981b9.js"><link rel="prefetch" href="/assets/js/71.2b1e967f.js"><link rel="prefetch" href="/assets/js/72.6318645f.js"><link rel="prefetch" href="/assets/js/73.3faeed28.js"><link rel="prefetch" href="/assets/js/74.2a11264d.js"><link rel="prefetch" href="/assets/js/75.a6a5ffb8.js"><link rel="prefetch" href="/assets/js/76.72a20d8b.js"><link rel="prefetch" href="/assets/js/77.b3cdf221.js"><link rel="prefetch" href="/assets/js/78.2953c168.js"><link rel="prefetch" href="/assets/js/79.91fd320a.js"><link rel="prefetch" href="/assets/js/8.90565e92.js"><link rel="prefetch" href="/assets/js/80.5843330d.js"><link rel="prefetch" href="/assets/js/81.14d99877.js"><link rel="prefetch" href="/assets/js/82.ba311f80.js"><link rel="prefetch" href="/assets/js/83.ec87add2.js"><link rel="prefetch" href="/assets/js/85.e6f08881.js"><link rel="prefetch" href="/assets/js/86.74f07619.js"><link rel="prefetch" href="/assets/js/87.18c7d05f.js"><link rel="prefetch" href="/assets/js/88.1b3ea410.js"><link rel="prefetch" href="/assets/js/89.b4fcd16a.js"><link rel="prefetch" href="/assets/js/9.c5246f94.js"><link rel="prefetch" href="/assets/js/90.bc040e3f.js"><link rel="prefetch" href="/assets/js/91.f7fd0dba.js"><link rel="prefetch" href="/assets/js/92.e8817e0b.js"><link rel="prefetch" href="/assets/js/93.828f1258.js"><link rel="prefetch" href="/assets/js/94.313ccd10.js"><link rel="prefetch" href="/assets/js/95.74091f38.js"><link rel="prefetch" href="/assets/js/96.cd1cacbe.js"><link rel="prefetch" href="/assets/js/97.a16176b2.js"><link rel="prefetch" href="/assets/js/98.a8d2d226.js"><link rel="prefetch" href="/assets/js/99.0da86133.js">
    <link rel="stylesheet" href="/assets/css/0.styles.75cec9a2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo-small.png" alt="Rocket Pool" class="logo"> <span class="site-name can-hide">Rocket Pool</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/guides/" class="nav-link">
  Guides
</a></div><div class="nav-item"><a href="/developers/" class="nav-link router-link-active">
  For Developers
</a></div><div class="nav-item"><a href="https://www.rocketpool.net" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Website
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://discord.com/invite/rocketpool" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/rocket-pool/docs.rocketpool.net" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/guides/" class="nav-link">
  Guides
</a></div><div class="nav-item"><a href="/developers/" class="nav-link router-link-active">
  For Developers
</a></div><div class="nav-item"><a href="https://www.rocketpool.net" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Website
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://discord.com/invite/rocketpool" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/rocket-pool/docs.rocketpool.net" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>For Developers</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/developers/" aria-current="page" class="sidebar-link">Developer Documentation</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Integration Usage and Examples</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/developers/usage/contracts/contracts.html" class="sidebar-link">Smart Contracts</a></li><li><a href="/developers/usage/go/go.html" aria-current="page" class="active sidebar-link">[WIP] Go Library</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#installing-and-importing-the-go-library" class="sidebar-link">Installing and Importing the Go Library</a></li><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#initializing-the-rocket-pool-manager" class="sidebar-link">Initializing the Rocket Pool Manager</a></li><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#a-simple-example-reading-the-deposit-pool-s-balance" class="sidebar-link">A Simple Example: Reading the Deposit Pool's Balance</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#converting-between-wei-gwei-and-eth-values" class="sidebar-link">Converting Between Wei, Gwei, and ETH Values</a></li></ul></li><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#transaction-example-staking-with-the-staking-pool" class="sidebar-link">Transaction Example: Staking with the Staking Pool</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#preparing-transactor-options" class="sidebar-link">Preparing Transactor Options</a></li><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#simulating-transactions-and-calculating-gas-limits" class="sidebar-link">Simulating Transactions and Calculating Gas Limits</a></li><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#executing-transactions" class="sidebar-link">Executing Transactions</a></li><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#waiting-for-transactions-to-finish" class="sidebar-link">Waiting for Transactions to Finish</a></li></ul></li><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#pool-staking-reference" class="sidebar-link">Pool Staking Reference</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#statistics" class="sidebar-link">Statistics</a></li><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#staking-eth-for-reth" class="sidebar-link">Staking ETH for rETH</a></li><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#unstaking-reth-for-eth" class="sidebar-link">Unstaking rETH for ETH</a></li></ul></li><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#network-statistics-reference" class="sidebar-link">Network Statistics Reference</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#node-count" class="sidebar-link">Node Count</a></li><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#minipool-count" class="sidebar-link">Minipool Count</a></li><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#current-node-fee-commission-rate" class="sidebar-link">Current Node Fee (Commission Rate)</a></li><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#total-and-effective-total-rpl-staked" class="sidebar-link">Total and Effective Total RPL Staked</a></li><li class="sidebar-sub-header"><a href="/developers/usage/go/go.html#next-checkpoint-time" class="sidebar-link">Next Checkpoint Time</a></li></ul></li></ul></li><li><a href="/developers/usage/js/js.html" class="sidebar-link">Javascript</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>API Reference</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="wip-go-library"><a href="#wip-go-library" class="header-anchor">#</a> [WIP] Go Library</h1> <p><em>The following page is written for <strong>v1.0.1</strong> of the library.</em> <em>We will update it with any breaking changes as they come, but otherwise assume that newer versions are still compatible with the descriptions here.</em></p> <p>Rocket Pool is a decentralized staking platform for the Ethereum Beacon Chain that is built entirely using smart contracts on the Ethereum blockchain.
This library wraps those smart contracts so they can be used in Go programs.</p> <p>This page demonstrates several simple examples that a provide a walkthrough of Rocket Pool's Go bindings for the smart contracts.</p> <div class="custom-block warning"><p class="custom-block-title">NOTE</p> <p>This guide assumes you are already familiar with the Go ecosystem and how to use the language.</p></div> <h2 id="installing-and-importing-the-go-library"><a href="#installing-and-importing-the-go-library" class="header-anchor">#</a> Installing and Importing the Go Library</h2> <p>To get the Go library, simply run the following:</p> <div class="language- extra-class"><pre class="language-text"><code>go get github.com/rocket-pool/rocketpool-go@v1.0.1
</code></pre></div><p>You can also add it manually to <code>go.mod</code> with the following:</p> <div class="language- extra-class"><pre class="language-text"><code>require (
	github.com/rocket-pool/rocketpool-go v1.0.1
    ...
)
</code></pre></div><p>Run <code>go mod tidy</code> afterwards to pull down the appropriate version into your cache.</p> <p>As you may expect, all of the packages contained in the library stem from the <code>github.com/rocket-pool/rocketpool-go/</code> package.</p> <h2 id="initializing-the-rocket-pool-manager"><a href="#initializing-the-rocket-pool-manager" class="header-anchor">#</a> Initializing the Rocket Pool Manager</h2> <p>The core interface to all of Rocket Pool's contracts is the <a href="/developers/api/go/rocketpool.html#type-rocketpool">rocketpool.RocketPool</a> type.
It is created in this section using the <a href="/developers/api/go/rocketpool.html#func-newrocketpool">rocketpool.NewRocketPool()</a> function.</p> <p>Use the following imports:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;github.com/ethereum/go-ethereum/common&quot;</span>
	<span class="token string">&quot;github.com/ethereum/go-ethereum/ethclient&quot;</span>
	
	<span class="token string">&quot;github.com/rocket-pool/rocketpool-go/rocketpool&quot;</span>
<span class="token punctuation">)</span>
</code></pre></div><p>Now, create the contract manager:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// Set up the arguments</span>
eth1Address <span class="token operator">:=</span> <span class="token string">&quot;http://my-eth1-client:port&quot;</span>
rocketStorage <span class="token operator">:=</span> <span class="token string">&quot;hex-string-address-of-rocket-storage-contract&quot;</span>

<span class="token comment">// Connect to ETH1</span>
ethClient<span class="token punctuation">,</span> err <span class="token operator">:=</span> ethclient<span class="token punctuation">.</span><span class="token function">Dial</span><span class="token punctuation">(</span>eth1Address<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Error connecting to ETH1 client on %s: %s\n&quot;</span><span class="token punctuation">,</span> eth1Address<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Create RP manager</span>
rp<span class="token punctuation">,</span> err <span class="token operator">:=</span> rocketpool<span class="token punctuation">.</span><span class="token function">NewRocketPool</span><span class="token punctuation">(</span>ethClient<span class="token punctuation">,</span> common<span class="token punctuation">.</span><span class="token function">HexToAddress</span><span class="token punctuation">(</span>rocketStorage<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Error getting RocketStorage contract at address %s: %s\n&quot;</span><span class="token punctuation">,</span> rocketStorage<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You will need to pass in an <code>ethclient.Client</code> object which is connected to an Eth1 client on the appropriate network (Goerli for the testnet, or mainnet once it's released).
This is created using the <code>ethclient.Dial()</code> function from <code>go-ethereum</code>, which we assume you are already familiar with.</p> <p>The second parameter is created using the hex string of the <code>RocketStorage</code> contract.
You can retrieve this address from the <a href="https://github.com/rocket-pool/smartnode-install/blob/master/amd64/rp-smartnode-install/network/prater/config.yml#L2" target="_blank" rel="noopener noreferrer">Smartnode configuration file for Prater<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://github.com/rocket-pool/smartnode-install/blob/master/amd64/rp-smartnode-install/network/mainnet/config.yml#L2" target="_blank" rel="noopener noreferrer">the configuration file for Mainnet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, depending on which you want to use.</p> <p>Once you have this manager object created, you can use it to interact with the rest of the library.</p> <h2 id="a-simple-example-reading-the-deposit-pool-s-balance"><a href="#a-simple-example-reading-the-deposit-pool-s-balance" class="header-anchor">#</a> A Simple Example: Reading the Deposit Pool's Balance</h2> <p>As a simple first demonstration of how to use the API, let's get the balance of the Deposit Pool (also known as the Staking Pool).
This is the available balance that pool stakers have deposited, which has yet to be put to work on the Beacon Chain by node operators.</p> <p>Start with the following additional imports:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;github.com/rocket-pool/rocketpool-go/deposit&quot;</span>
    <span class="token string">&quot;github.com/rocket-pool/rocketpool-go/utils/eth&quot;</span>
<span class="token punctuation">)</span>
</code></pre></div><p>Next, use the following snippet:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// Get the deposit pool balance</span>
depositPoolBalance<span class="token punctuation">,</span> err <span class="token operator">:=</span> deposit<span class="token punctuation">.</span><span class="token function">GetBalance</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Error getting the deposit pool balance: %s\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Deposit Pool Balance: %f\n&quot;</span><span class="token punctuation">,</span> eth<span class="token punctuation">.</span><span class="token function">WeiToEth</span><span class="token punctuation">(</span>depositPoolBalance<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>The <a href="/developers/api/go/deposit.html#func-getbalance">deposit.GetBalance()</a> function will return the amount of ETH in the staking pool.</p> <h3 id="converting-between-wei-gwei-and-eth-values"><a href="#converting-between-wei-gwei-and-eth-values" class="header-anchor">#</a> Converting Between Wei, Gwei, and ETH Values</h3> <p>Note that most of the functions in the Go bindings use <code>*big.Int</code> as a construct for passing numbers back and forth between the smart contracts.
To make these more user-friendly, they can be easily converted into floats using the <a href="/developers/api/go/utils-eth.html#func-weitoeth">eth.WeiToEth()</a> utility function and back using the <a href="/developers/api/go/utils-eth.html#func-ethtowei">eth.EthToWei()</a> function.
The <a href="/developers/api/go/utils-eth.html">utils/eth</a> package has several such helper methods to convert back and forth between human-readable values and values that are used by the smart contracts.</p> <h2 id="transaction-example-staking-with-the-staking-pool"><a href="#transaction-example-staking-with-the-staking-pool" class="header-anchor">#</a> Transaction Example: Staking with the Staking Pool</h2> <p>The following snippet demonstrates how to stake ETH into the Staking Pool and receive rETH in return.</p> <p>You will need the following imports:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;context&quot;</span>
	<span class="token string">&quot;crypto/ecdsa&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;math/big&quot;</span>
	<span class="token string">&quot;os&quot;</span>

	<span class="token string">&quot;github.com/ethereum/go-ethereum/accounts/abi/bind&quot;</span>
	<span class="token string">&quot;github.com/ethereum/go-ethereum/common&quot;</span>
	<span class="token string">&quot;github.com/ethereum/go-ethereum/ethclient&quot;</span>

	<span class="token string">&quot;github.com/rocket-pool/rocketpool-go/deposit&quot;</span>
	<span class="token string">&quot;github.com/rocket-pool/rocketpool-go/rocketpool&quot;</span>
	<span class="token string">&quot;github.com/rocket-pool/rocketpool-go/utils&quot;</span>
	<span class="token string">&quot;github.com/rocket-pool/rocketpool-go/utils/eth&quot;</span>
<span class="token punctuation">)</span>
</code></pre></div><p>Start by retrieving the private key used for signing the transaction, and specifying the chain ID you want to execute the transaction on:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// You'll have to retrieve this key for your user in your system</span>
<span class="token keyword">var</span> privateKey <span class="token operator">*</span>ecdsa<span class="token punctuation">.</span>PrivateKey

<span class="token comment">// 1 for Mainnet, but insert your chain ID of choice here (e.g. 5 for Goerli)</span>
chainID <span class="token operator">:=</span> big<span class="token punctuation">.</span><span class="token function">NewInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="preparing-transactor-options"><a href="#preparing-transactor-options" class="header-anchor">#</a> Preparing Transactor Options</h3> <p>Next, prepare the transactor options:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// Set up the transactor options</span>
opts<span class="token punctuation">,</span> err <span class="token operator">:=</span> bind<span class="token punctuation">.</span><span class="token function">NewKeyedTransactorWithChainID</span><span class="token punctuation">(</span>privateKey<span class="token punctuation">,</span> chainID<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Error getting Transactor options: %s\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
opts<span class="token punctuation">.</span>GasFeeCap <span class="token operator">=</span> <span class="token boolean">nil</span> <span class="token comment">// Max total gas fee - nil uses the internal oracle</span>
opts<span class="token punctuation">.</span>GasTipCap <span class="token operator">=</span> <span class="token boolean">nil</span> <span class="token comment">// Max priority fee - nil uses the internal oracle</span>
opts<span class="token punctuation">.</span>GasLimit <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">// When set to 0, the library will automatically calculate it</span>
opts<span class="token punctuation">.</span>Context <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Note that the current Geth library uses <code>opts.GasFeeCap</code> and <code>opts.GasTipCap</code> to specify the total maximum fee and the maximum priority fee (introduced with EIP 1559) respectively.</p> <p>The <code>opts.GasLimit</code> can be left at 0; the library will automatically calculate the appropriate value (the estimated gas limit produced by simulating the transaction, multiplied by 1.5 for a wide margin of safety).</p> <p>Next, specify the amount of ETH to deposit into the Staking Pool:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// Set Value to be the amount of ETH you want to stake, in wei</span>
amountToStake <span class="token operator">:=</span> <span class="token number">1.0</span>
opts<span class="token punctuation">.</span>Value <span class="token operator">=</span> eth<span class="token punctuation">.</span><span class="token function">EthToWei</span><span class="token punctuation">(</span>amountToStake<span class="token punctuation">)</span>
</code></pre></div><p>This is another instance where the <code>eth.EthToWei()</code> utility function comes in handy.</p> <h3 id="simulating-transactions-and-calculating-gas-limits"><a href="#simulating-transactions-and-calculating-gas-limits" class="header-anchor">#</a> Simulating Transactions and Calculating Gas Limits</h3> <p>Now that the options are set, simulate the transaction:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// Simulate the transaction to make sure it is allowed, and get the gas estimate</span>
gasInfo<span class="token punctuation">,</span> err <span class="token operator">:=</span> deposit<span class="token punctuation">.</span><span class="token function">EstimateDepositGas</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> opts<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Error simulating Deposit: %s\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Staking %f ETH\n&quot;</span><span class="token punctuation">,</span> amountToStake<span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Estimated gas needed: %d to %d&quot;</span><span class="token punctuation">,</span> gasInfo<span class="token punctuation">.</span>EstGasLimit<span class="token punctuation">,</span> gasInfo<span class="token punctuation">.</span>SafeGasLimit<span class="token punctuation">)</span>
</code></pre></div><p>Each transaction function in the Rocket Pool library comes with a corresponding <code>EstimateXYZGas()</code> function - in this example, the function is <a href="/developers/api/go/deposit.html#func-estimatedepositgas">deposit.EstimateDepositGas()</a>.
This will run through the transaction as though it were real, but not actually commit anything to the blockchain.
It will verify that the transaction is valid and will succeed (e.g. nothing in the current state will cause it to revert).
If the simulation succeeds, it will provide some information about the expected gas cost of the function.
If the simulation fails, it will return an error indicating why (e.g. the revert message that the contract returned).</p> <h3 id="executing-transactions"><a href="#executing-transactions" class="header-anchor">#</a> Executing Transactions</h3> <p>At this point, it's a good idea to present the gas information to the user so they can decide if they accept the cost of the transaction, or modify it accordingly.
Once they're satisfied, run the actual transaction:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// This is where you can ask the user if they're alright with these gas limits,</span>
<span class="token comment">// and let them overwrite the max fees if desired</span>

<span class="token comment">// Run the deposit to stake the ETH and receive rETH</span>
txHash<span class="token punctuation">,</span> err <span class="token operator">:=</span> deposit<span class="token punctuation">.</span><span class="token function">Deposit</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> opts<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Error during Deposit: %s\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Transaction submitted with hash %s\n&quot;</span><span class="token punctuation">,</span> txHash<span class="token punctuation">.</span><span class="token function">Hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>All transaction functions (such as <a href="/developers/api/go/deposit.html#func-deposit">deposit.Deposit()</a> used here) will return the hash of the transaction that was submitted.
You can display this to the user (presumably with a link to a chain explorer).</p> <h3 id="waiting-for-transactions-to-finish"><a href="#waiting-for-transactions-to-finish" class="header-anchor">#</a> Waiting for Transactions to Finish</h3> <p>If you want to wait for the transaction to complete before moving forward, you can do the following:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// Print a waiting message</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Waiting for it to be mined...&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// Wait for the transaction to be mined</span>
<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> utils<span class="token punctuation">.</span><span class="token function">WaitForTransaction</span><span class="token punctuation">(</span>ethClient<span class="token punctuation">,</span> txHash<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Error waiting for transaction: %s\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Successfully staked ETH for rETH!&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>This leverages the <a href="/developers/api/go/utils.html#func-waitfortransaction">utils.WaitForTransaction()</a> function to block until the transaction has been successfully mined.</p> <h2 id="pool-staking-reference"><a href="#pool-staking-reference" class="header-anchor">#</a> Pool Staking Reference</h2> <p>This section describes common operations involving the staking pool.</p> <h3 id="statistics"><a href="#statistics" class="header-anchor">#</a> Statistics</h3> <p>The staking pool's current balance:</p> <div class="language-go extra-class"><pre class="language-go"><code>depositPoolBalance<span class="token punctuation">,</span> err <span class="token operator">:=</span> deposit<span class="token punctuation">.</span><span class="token function">GetBalance</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> err
<span class="token punctuation">}</span>
balanceEth <span class="token operator">:=</span> eth<span class="token punctuation">.</span><span class="token function">WeiToEth</span><span class="token punctuation">(</span>depositPoolBalance<span class="token punctuation">)</span>
<span class="token keyword">return</span> balanceEth<span class="token punctuation">,</span> <span class="token boolean">nil</span>
</code></pre></div><p>The ETH/rETH exchange rate:</p> <div class="language-go extra-class"><pre class="language-go"><code>exchangeRate<span class="token punctuation">,</span> err <span class="token operator">:=</span> tokens<span class="token punctuation">.</span><span class="token function">GetRETHExchangeRate</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> err
<span class="token punctuation">}</span>
<span class="token keyword">return</span> exchangeRate<span class="token punctuation">,</span> <span class="token boolean">nil</span>
</code></pre></div><h3 id="staking-eth-for-reth"><a href="#staking-eth-for-reth" class="header-anchor">#</a> Staking ETH for rETH</h3> <p>Staking uses the <a href="/developers/api/go/deposit.html#func-deposit">deposit.Deposit()</a> function:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// This assumes you already have the private key and chain ID from elsewhere</span>
opts<span class="token punctuation">,</span> err <span class="token operator">:=</span> bind<span class="token punctuation">.</span><span class="token function">NewKeyedTransactorWithChainID</span><span class="token punctuation">(</span>privateKey<span class="token punctuation">,</span> chainID<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error getting Transactor options: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
opts<span class="token punctuation">.</span>GasFeeCap <span class="token operator">=</span> <span class="token boolean">nil</span> <span class="token comment">// Set to the user's desired max total transaction fee</span>
opts<span class="token punctuation">.</span>GasTipCap <span class="token operator">=</span> <span class="token boolean">nil</span> <span class="token comment">// Set to the user's desired max priority fee</span>
opts<span class="token punctuation">.</span>Context <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// Set Value to be the amount of ETH you want to stake, in wei</span>
amountToStake <span class="token operator">:=</span> <span class="token number">1.0</span>
opts<span class="token punctuation">.</span>Value <span class="token operator">=</span> eth<span class="token punctuation">.</span><span class="token function">EthToWei</span><span class="token punctuation">(</span>amountToStake<span class="token punctuation">)</span>

<span class="token comment">// Simulate the transaction to make sure it is allowed, and get the gas estimate</span>
gasInfo<span class="token punctuation">,</span> err <span class="token operator">:=</span> deposit<span class="token punctuation">.</span><span class="token function">EstimateDepositGas</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> opts<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error simulating Deposit: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// This is where you can ask the user if they're alright with these gas limits,</span>
<span class="token comment">// and let them overwrite the max fees if desired</span>

<span class="token comment">// Run the deposit to stake the ETH and receive rETH</span>
txHash<span class="token punctuation">,</span> err <span class="token operator">:=</span> deposit<span class="token punctuation">.</span><span class="token function">Deposit</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> opts<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error during Deposit: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Wait for the transaction to be mined</span>
<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> utils<span class="token punctuation">.</span><span class="token function">WaitForTransaction</span><span class="token punctuation">(</span>ethClient<span class="token punctuation">,</span> txHash<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error waiting for transaction: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">return</span> <span class="token boolean">nil</span>
</code></pre></div><h3 id="unstaking-reth-for-eth"><a href="#unstaking-reth-for-eth" class="header-anchor">#</a> Unstaking rETH for ETH</h3> <p>Unstaking uses the <a href="/developers/api/go/tokens.html#func-burnreth">tokens.BurnRETH()</a> function:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// This assumes you already have the private key and chain ID from elsewhere</span>
opts<span class="token punctuation">,</span> err <span class="token operator">:=</span> bind<span class="token punctuation">.</span><span class="token function">NewKeyedTransactorWithChainID</span><span class="token punctuation">(</span>privateKey<span class="token punctuation">,</span> chainID<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error getting Transactor options: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
opts<span class="token punctuation">.</span>GasFeeCap <span class="token operator">=</span> <span class="token boolean">nil</span> <span class="token comment">// Set to the user's desired max total transaction fee</span>
opts<span class="token punctuation">.</span>GasTipCap <span class="token operator">=</span> <span class="token boolean">nil</span> <span class="token comment">// Set to the user's desired max priority fee</span>
opts<span class="token punctuation">.</span>Context <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// Set Value to be the amount of rETH you want to unstake</span>
rEthToBurn <span class="token operator">:=</span> <span class="token number">1.0</span>
rEthToBurnWei <span class="token operator">:=</span> eth<span class="token punctuation">.</span><span class="token function">EthToWei</span><span class="token punctuation">(</span>rEthToBurn<span class="token punctuation">)</span>

<span class="token comment">// Simulate the transaction to make sure it is allowed, and get the gas estimate</span>
gasInfo<span class="token punctuation">,</span> err <span class="token operator">:=</span> tokens<span class="token punctuation">.</span><span class="token function">EstimateBurnRETHGas</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> rEthToBurnWei<span class="token punctuation">,</span> opts<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error simulating unstake: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// This is where you can ask the user if they're alright with these gas limits,</span>
<span class="token comment">// and let them overwrite the max fees if desired</span>

txHash<span class="token punctuation">,</span> err <span class="token operator">:=</span> tokens<span class="token punctuation">.</span><span class="token function">BurnRETH</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> rEthToBurnWei<span class="token punctuation">,</span> opts<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error during unstake: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Wait for the transaction to be mined</span>
<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> utils<span class="token punctuation">.</span><span class="token function">WaitForTransaction</span><span class="token punctuation">(</span>ethClient<span class="token punctuation">,</span> txHash<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error waiting for transaction: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">return</span> <span class="token boolean">nil</span>
</code></pre></div><h2 id="network-statistics-reference"><a href="#network-statistics-reference" class="header-anchor">#</a> Network Statistics Reference</h2> <p>This section describes how to get some useful statistics about the Rocket Pool network.</p> <h3 id="node-count"><a href="#node-count" class="header-anchor">#</a> Node Count</h3> <p>The number of nodes registered with Rocket Pool comes from the <a href="/developers/api/go/node.html#func-getnodecount">node.GetNodeCount()</a> function:</p> <div class="language-go extra-class"><pre class="language-go"><code>nodeCount<span class="token punctuation">,</span> err <span class="token operator">:=</span> node<span class="token punctuation">.</span><span class="token function">GetNodeCount</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error getting total number of Rocket Pool nodes: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="minipool-count"><a href="#minipool-count" class="header-anchor">#</a> Minipool Count</h3> <p>The number of minipools can be retrieved with <a href="/developers/api/go/minipool.html#func-getminipoolcountperstatus">minipool.GetMinipoolCountPerStatus()</a> for active minipools, which breaks up into counts for each different status.
The number of finalized pools can be retrieved with <a href="/developers/api/go/minipool.html#func-getfinalisedminipoolcount">minipool.GetFinalisedMinipoolCount()</a>.</p> <p>The statuses are described as follows:</p> <ul><li><strong>Initialized</strong>: waiting for a deposit still</li> <li><strong>Prelaunch:</strong> deposits are done, waiting to be staked by the node operator's <code>rocketpool_node</code> container</li> <li><strong>Staking:</strong> deposited, validator created, and active (or pending) on the Beacon Chain</li> <li><strong>Dissolved:</strong> staking failed, funds returned to the node operator and staking pool</li> <li><strong>Withdrawable:</strong> exited from the Beacon Chain, waiting for rewards to be withdrawn to the minipool</li> <li><strong>Finalized:</strong> exited, withdrawn from, and essentially closed (inactive)</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// The 2nd and 3rd parameters are for batching support if necessary</span>
minipoolCounts<span class="token punctuation">,</span> err <span class="token operator">:=</span> minipool<span class="token punctuation">.</span><span class="token function">GetMinipoolCountPerStatus</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error getting total number of Rocket Pool minipools: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
initializedCount <span class="token operator">:=</span> minipoolCounts<span class="token punctuation">.</span>Initialized<span class="token punctuation">.</span><span class="token function">Uint64</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
prelaunchCount <span class="token operator">:=</span> minipoolCounts<span class="token punctuation">.</span>Prelaunch<span class="token punctuation">.</span><span class="token function">Uint64</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
stakingCount <span class="token operator">:=</span> minipoolCounts<span class="token punctuation">.</span>Staking<span class="token punctuation">.</span><span class="token function">Uint64</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
withdrawableCount <span class="token operator">:=</span> minipoolCounts<span class="token punctuation">.</span>Withdrawable<span class="token punctuation">.</span><span class="token function">Uint64</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
dissolvedCount <span class="token operator">:=</span> minipoolCounts<span class="token punctuation">.</span>Dissolved<span class="token punctuation">.</span><span class="token function">Uint64</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

finalizedCount<span class="token punctuation">,</span> err <span class="token operator">:=</span> minipool<span class="token punctuation">.</span><span class="token function">GetFinalisedMinipoolCount</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error getting total number of Rocket Pool minipools: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Remove the number of finalized pools from the number of withdrawable pools,</span>
<span class="token comment">// because finalized pools always have the withdrawable state</span>
withdrawableCount <span class="token operator">-=</span> finalizedCount
<span class="token keyword">return</span> <span class="token boolean">nil</span>
</code></pre></div><h3 id="current-node-fee-commission-rate"><a href="#current-node-fee-commission-rate" class="header-anchor">#</a> Current Node Fee (Commission Rate)</h3> <p>The <a href="/developers/api/go/network.html#func-getnodefee">network.GetNodeFee()</a> function will retrieve the current commission rate for new minipools based on the size of the deposit pool:</p> <div class="language-go extra-class"><pre class="language-go"><code>nodeFee<span class="token punctuation">,</span> err <span class="token operator">:=</span> network<span class="token punctuation">.</span><span class="token function">GetNodeFee</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error getting current node fee for new minipools: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="total-and-effective-total-rpl-staked"><a href="#total-and-effective-total-rpl-staked" class="header-anchor">#</a> Total and Effective Total RPL Staked</h3> <p>The total amount of RPL staked across the network can be found with the <a href="/developers/api/go/node.html#func-gettotalrplstake">node.GetTotalRPLStake()</a> function:</p> <div class="language-go extra-class"><pre class="language-go"><code>totalValueStakedWei<span class="token punctuation">,</span> err <span class="token operator">:=</span> node<span class="token punctuation">.</span><span class="token function">GetTotalRPLStake</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error getting total effective amount of RPL staked on the network: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
totalValueStaked <span class="token operator">:=</span> eth<span class="token punctuation">.</span><span class="token function">WeiToEth</span><span class="token punctuation">(</span>totalValueStakedWei<span class="token punctuation">)</span>
</code></pre></div><p>The <em>effective</em> total amount of RPL staked (which honors the 150% collateral reward limit) comes from the <a href="/developers/api/go/node.html#func-gettotaleffectiverplstake">node.GetTotalEffectiveRPLStake()</a> function:</p> <div class="language-go extra-class"><pre class="language-go"><code>totalEffectiveStakedWei<span class="token punctuation">,</span> err <span class="token operator">:=</span> node<span class="token punctuation">.</span><span class="token function">GetTotalEffectiveRPLStake</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error getting total effective amount of RPL staked on the network: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
totalEffectiveStaked <span class="token operator">:=</span> eth<span class="token punctuation">.</span><span class="token function">WeiToEth</span><span class="token punctuation">(</span>totalEffectiveStakedWei<span class="token punctuation">)</span>
</code></pre></div><h3 id="next-checkpoint-time"><a href="#next-checkpoint-time" class="header-anchor">#</a> Next Checkpoint Time</h3> <p>The time of the next checkpoint can be retrieved as a Unix timestamp.
You will need to call two functions to get it - first, the timestamp for the start of the current claim period with <a href="/developers/api/go/rewards.html#func-getclaimintervaltimestart">rewards.GetClaimIntervalTimeStart()</a> and second, the interval time with <a href="/developers/api/go/rewards.html#func-getclaimintervaltime">rewards.GetClaimIntervalTime()</a>:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// Get the timestamp for the start of the current claim period</span>
lastCheckpoint<span class="token punctuation">,</span> err <span class="token operator">:=</span> rewards<span class="token punctuation">.</span><span class="token function">GetClaimIntervalTimeStart</span><span class="token punctuation">(</span>collector<span class="token punctuation">.</span>rp<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error getting the start of the rewards claim period: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Get the rewards checkpoint interval</span>
rewardsInterval<span class="token punctuation">,</span> err <span class="token operator">:=</span> rewards<span class="token punctuation">.</span><span class="token function">GetClaimIntervalTime</span><span class="token punctuation">(</span>collector<span class="token punctuation">.</span>rp<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Error getting the rewards interval: %w&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// This is the Unix timestamp for the end of the current reward period</span>
nextRewardsTime <span class="token operator">:=</span> <span class="token function">float64</span><span class="token punctuation">(</span>lastCheckpoint<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>rewardsInterval<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Unix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/rocket-pool/docs.rocketpool.net/edit/main/src/developers/usage/go/go.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/developers/usage/contracts/contracts.html" class="prev">
        Smart Contracts
      </a></span> <span class="next"><a href="/developers/usage/js/js.html">
        Javascript
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8dab053a.js" defer></script><script src="/assets/js/3.12e2602a.js" defer></script><script src="/assets/js/84.8e331b8d.js" defer></script>
  </body>
</html>
